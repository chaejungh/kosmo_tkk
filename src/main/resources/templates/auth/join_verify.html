<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì´ë©”ì¼ ì¸ì¦ | ë”ì¿ ì¿ </title>

    <style>
        :root {
            --purple: #6366f1;
            --purple-deep: #4f46e5;
            --bg: #f5f3ff;
            --card-bg: #ffffff;
            --border: #e5e7eb;
            --text-main: #111827;
            --text-sub: #6b7280;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--bg);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .verify-card {
            width: 420px;
            background: var(--card-bg);
            padding: 32px 28px;
            border-radius: 28px;
            box-shadow: 0 16px 40px rgba(0,0,0,0.12);
            text-align: center;
        }

        .title {
            font-size: 22px;
            font-weight: 800;
            color: var(--purple);
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-sub);
            margin-bottom: 24px;
        }

        .input-code {
            width: 100%;
            max-width: 260px;   /* ğŸ”¥ ì¶”ê°€: inputì´ ë¶€ëª¨ ë„ˆë¹„ë¥¼ ë„˜ì§€ ì•Šë„ë¡ ì œí•œ */
            height: 52px;
            border-radius: 12px;
            border: 1px solid var(--border);
            padding: 0 16px;
            font-size: 22px;   /* ì¡°ê¸ˆ ë” ì„ ëª…í•˜ê²Œ */
            letter-spacing: 8px;   /* ğŸ”¥ ìˆ«ì ê°„ê²©ì„ ë” ë„“í˜€ë„ íŠ€ì–´ë‚˜ì˜¤ì§€ ì•ŠìŒ */
            text-align: center;
            outline: none;
            margin: 0 auto;    /* ğŸ”¥ ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
        }


        .input-code:focus {
            border-color: var(--purple);
            box-shadow: 0 0 0 1px rgba(99,102,241,0.2);
        }

        .btn-submit {
            margin-top: 18px;
            width: 100%;
            height: 50px;
            border-radius: 14px;
            border: none;
            background: var(--purple);
            color: white;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
        }

        .btn-submit:hover {
            background: var(--purple-deep);
        }

        .resend-area {
            margin-top: 14px;
        }

        .resend-btn {
            color: var(--purple);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            background: none;
            border: none;
            padding: 4px 0;
        }

        .timer {
            font-size: 13px;
            color: var(--text-sub);
            margin-top: 6px;
        }
    </style>
</head>

<body>
<div class="verify-card">
    <div class="title">ì´ë©”ì¼ ì¸ì¦</div>
    <div class="subtitle">ì´ë©”ì¼ë¡œ ì „ì†¡ëœ ì¸ì¦ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

    <form action="/auth/verify" method="post">
        <input type="hidden" name="email" id="email" th:value="${email}">

        <input class="input-code" type="text" name="code" maxlength="6"
               placeholder="000000" required>

        <button class="btn-submit" type="submit">ì¸ì¦í•˜ê¸°</button>
    </form>

    <div class="resend-area">
        <button class="resend-btn" onclick="resendCode()">ì¸ì¦ì½”ë“œ ì¬ì „ì†¡</button>
        <div class="timer" id="timerText">ë‚¨ì€ ì‹œê°„: 03:00</div>
    </div>
</div>

<script>
    async function resendCode() {
        const email = document.getElementById("email").value;

        const res = await fetch("/auth/send-code", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: "email=" + encodeURIComponent(email)
        });

        const result = await res.text();

        if (result === "OK") {
            alert("ì¸ì¦ì½”ë“œê°€ ì¬ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
            resetTimer();
        }
    }

    // 3ë¶„ íƒ€ì´ë¨¸
    let time = 180;
    let timerInterval;

    function startTimer() {
        timerInterval = setInterval(() => {
            if (time <= 0) {
                clearInterval(timerInterval);
                document.getElementById("timerText").innerText = "ì¸ì¦ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
                return;
            }

            const min = String(Math.floor(time / 60)).padStart(2, "0");
            const sec = String(time % 60).padStart(2, "0");

            document.getElementById("timerText").innerText = `ë‚¨ì€ ì‹œê°„: ${min}:${sec}`;

            time--;
        }, 1000);
    }

    function resetTimer() {
        clearInterval(timerInterval);
        time = 180;
        startTimer();
    }

    startTimer();
</script>

</body>
</html>
