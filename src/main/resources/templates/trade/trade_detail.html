<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/tkk_fragment/layout}">
<head>
    <title th:text="${trade.title} + ' | ÍµøÏ¶àÍ±∞Îûò | ÎçîÏø†Ïø†'">ÍµøÏ¶àÍ±∞Îûò ÏÉÅÏÑ∏ | ÎçîÏø†Ïø†</title>

</head>
<body>

<div layout:fragment="content">


    <header class="top-bar">
        <div class="top-bar-inner">
            <a class="back-btn" type="button" th:href="@{/trade/list.do}">‚Üê</a>
            <div class="top-title">ÍµøÏ¶àÍ±∞Îûò</div>
        </div>
    </header>

    <main class="detail-page"
          style="display: flex;
                 min-height: 76vh;
                 justify-content: center;
                 align-items: center;">

        <section class="detail-layout">

            <!-- üî• ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ -->
            <div class="image-box">
                <div class="image-frame">
                    <img th:src="${coverUrl}"
                         th:onclick="'location.href=\'/trade/' + ${trade.id} + '/article/' + ${coverImageId} + '/detail.do\''"
                         style="cursor:pointer;"
                         alt="ÍµøÏ¶à Ïù¥ÎØ∏ÏßÄ"/>
                </div>
            </div>

            <!-- Ïò§Î•∏Ï™Ω Ï†ïÎ≥¥ -->
            <div class="info-card">

                <!-- üîº ÌîÑÎ°úÌïÑ Ïπ¥Îìú (ÎãâÎÑ§ÏûÑ ÌÅ¥Î¶≠ ‚Üí ÌåêÎß§Ïûê Î¶¨Ïä§Ìä∏Î°ú Ïù¥Îèô) -->
                <div class="seller-card">
                    <div class="seller-avatar"><span>üë§</span></div>

                    <div class="seller-info-main">
                        <div class="seller-name">
                            <a th:href="@{|/trade/seller/${sellerId}|}"
                               th:text="${trade.seller != null ? trade.seller.nickname : 'ÌåêÎß§Ïûê #' + trade.sellerId}">
                                ÌåêÎß§Ïûê
                            </a>
                        </div>

                        <div class="seller-region"
                             th:text="${trade.region != null ? trade.region : 'ÏßÄÏó≠ ÎØ∏Îì±Î°ù'}"></div>
                    </div>
                    <div class="detail-header-actions"
                         th:if="${currentMemberId != null and currentMemberId == trade.sellerId}">
                        <a class="detail-action-btn"
                           th:href="@{'/trade/' + ${currentMemberId} + '/article/' + ${trade.id} + '/edit.do'}">
                            ÏàòÏ†ï
                        </a>
                        <a class="detail-action-btn detail-action-delete"
                           th:href="@{'/trade/' + ${currentMemberId} + '/article/' + ${trade.id} + '/delete.do'}"
                           onclick="return confirm('Í≤åÏãúÎ¨ºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?');">
                            ÏÇ≠Ï†ú
                        </a>
                    </div>
                </div>

                <!-- Í∏Ä Ï†úÎ™© -->
                <h1 class="title" th:text="${trade.title}"></h1>

                <!-- Îì±Î°ùÏùº -->
                <div class="meta">
                    <span th:text="${#temporals.format(trade.createdAt, 'MM/dd')} + ' Îì±Î°ù'"></span>
                </div>

                <!-- üîπ Ï¢ãÏïÑÏöî / Ï±ÑÌåÖ / Ï°∞ÌöåÏàò + ÌÜ†Í∏Ä ÌïòÌä∏ -->
                <div class="stats-row">

                    <!-- Îπà ÌïòÌä∏ (ÏïÑÏßÅ Ï∞ú ÏïàÌï®) -->
                    <form class="like-form"
                          th:if="${!liked}"
                          th:action="@{|/trade/${currentMemberId}/BookMark|}"
                          method="post">
                        <input type="hidden" name="tradeId" th:value="${trade.id}">
                        <button type="submit" class="like-btn">‚ô°</button>
                    </form>

                    <!-- Îπ®Í∞Ñ ÌïòÌä∏ (Ïù¥ÎØ∏ Ï∞úÌïú ÏÉÅÌÉú) -->
                    <form class="like-form"
                          th:if="${liked}"
                          th:action="@{|/trade/${currentMemberId}/BookMarkDelete|}"
                          method="post">
                        <input type="hidden" name="tradeId" th:value="${trade.id}">
                        <button type="submit" class="like-btn liked">‚ô•</button>
                    </form>

                    <span>
                        <span th:text="${likeCount}">0</span> Ï∞ú ¬∑
                        üí¨ <span th:text="${chatCount}">0</span> Ï±ÑÌåÖ ¬∑
                        Ï°∞Ìöå <span th:text="${trade.viewCount != null ? trade.viewCount : 0}">0</span>
                    </span>
                </div>

                <!-- Í∞ÄÍ≤© -->
                <div class="price"
                     th:text="${#numbers.formatInteger(trade.price, 0, 'COMMA')} + 'Ïõê'"></div>

                <div class="status-row">
                    <span class="status-badge"
                          th:classappend="${statusClass}"
                          th:text="${statusLabel}"></span>

                    <div class="label-row">
                        <span class="label-chip" th:text="${trade.category}"></span>
                        <span class="label-chip" th:text="${trade.tradeType}"></span>
                        <span class="label-chip" th:text="${trade.tradeMethod}"></span>
                    </div>
                </div>

                <div class="desc-box" th:text="${trade.content}"></div>

                <!-- Ï±ÑÌåÖÌïòÍ∏∞ Î≤ÑÌäº -->
                <div class="button-wrap">
                    <form
                            th:if="${trade.sellerId != currentMemberId}"
                            th:action="@{|/trade/${trade.id}/chat/start|}"
                          method="post" style="flex:1;">
                        <button type="submit" class="btn-main">Ï±ÑÌåÖÌïòÍ∏∞</button>
                    </form>
                </div>

            </div>
        </section>

    </main>
</div>
</body>
</html>