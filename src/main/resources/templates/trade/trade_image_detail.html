<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>ì´ë¯¸ì§€ ìƒì„¸ | êµ¿ì¦ˆê±°ë˜ | ë”ì¿ ì¿ </title>

    <style>
        body {
            margin: 0;
            background: #f9fafb;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .page {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .back-btn {
            margin-bottom: 12px;
            cursor: pointer;
            font-size: 15px;
            color: #555;
        }

        .image-wrap {
            position: relative;
        }

        .main-img-box {
            width: 100%;
            background: #ffffff;
            padding: 16px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            cursor: zoom-in;
            position: relative;
        }

        .main-img {
            width: 100%;
            border-radius: 12px;
            display: block;
            transition: transform 0.3s ease;
        }

        .zoomed {
            transform: scale(2.2);
            cursor: zoom-out;
        }

        /* ğŸ”¥ ì¢Œìš° í™”ì‚´í‘œ ë²„íŠ¼ */
        .arrow-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            padding: 14px 16px;
            border-radius: 50%;
            background: rgba(0,0,0,0.4);
            color: #fff;
            cursor: pointer;
            font-size: 22px;
            user-select: none;
        }

        .arrow-left {
            left: 6px;
        }

        .arrow-right {
            right: 6px;
        }

        .arrow-btn:hover {
            background: rgba(0,0,0,0.55);
        }

        .thumb-list {
            margin-top: 16px;
            display: flex;
            gap: 10px;
            overflow-x: auto;
        }

        .thumb-item {
            width: 90px;
            height: 90px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            flex-shrink: 0;
        }

        .thumb-item.active {
            border-color: #6366f1;
        }

        .thumb-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>

<body>

<div class="page">

    <div class="back-btn" onclick="history.back()">â† ëŒì•„ê°€ê¸°</div>

    <div class="image-wrap">

        <!-- ì¢Œì¸¡ í™”ì‚´í‘œ -->
        <div class="arrow-btn arrow-left" onclick="moveSlide(-1)">â®</div>

        <!-- ì´ë¯¸ì§€ ë°•ìŠ¤ -->
        <div class="main-img-box" id="zoomBox">

            <img th:each="img, iter : ${imageList}"
                 th:id="'img' + ${iter.index}"
                 th:src="${img.imageUrl}"
                 class="main-img"
                 th:style="${iter.index} == ${activeIndex} ? 'display:block' : 'display:none'"
                 alt="ì´ë¯¸ì§€"/>

        </div>

        <!-- ìš°ì¸¡ í™”ì‚´í‘œ -->
        <div class="arrow-btn arrow-right" onclick="moveSlide(1)">â¯</div>
    </div>

    <!-- ì¸ë„¤ì¼ -->
    <div class="thumb-list">

        <div th:each="img, iter : ${imageList}"
             th:classappend="${iter.index == activeIndex} ? 'active'"
             th:onclick="'changeImage(' + ${iter.index} + ')'"
             class="thumb-item">

            <img th:src="${img.imageUrl}" />
        </div>

    </div>

</div>


<script>
    let currentIndex = [[${activeIndex}]];
    const total = [[${#lists.size(imageList)}]];

    const zoomBox = document.getElementById("zoomBox");

    /* ğŸ”¥ ì´ë¯¸ì§€ ë³€ê²½ í•¨ìˆ˜ */
    function changeImage(index) {
        if (index < 0 || index >= total) return;

        currentIndex = index;

        const imgs = document.querySelectorAll(".main-img");
        imgs.forEach(img => img.style.display = "none");

        const target = document.getElementById("img" + index);
        if (target) {
            target.style.display = "block";
            target.classList.remove("zoomed");
        }

        updateThumb();
    }

    /* ğŸ”¥ ì¢Œìš° ì´ë™ */
    function moveSlide(step) {
        let next = currentIndex + step;

        if (next < 0 || next >= total) return;

        changeImage(next);
    }

    /* ì¸ë„¤ì¼ active í‘œì‹œ ì—…ë°ì´íŠ¸ */
    function updateThumb() {
        const thumbs = document.querySelectorAll(".thumb-item");
        thumbs.forEach((t, idx) => {
            t.classList.toggle("active", idx === currentIndex);
        });
    }

    /* ì´ˆê¸° active ì„¤ì • */
    updateThumb();

    // í™•ëŒ€ëŠ” ë©”ì¸ ë°•ìŠ¤ í´ë¦­í•  ë•Œë§Œ ì‘ë™í•˜ê²Œ
    zoomBox.addEventListener("click", (e) => {
        const img = document.getElementById("img" + currentIndex);
        if (!img) return;

        img.classList.toggle("zoomed");
    });
</script>

</body>
</html>