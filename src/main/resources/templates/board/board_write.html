<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/fragments/layout}">

<head>
    <th:block layout:fragment="head">
        <style>
            :root{
                --bg:#F3F4F6;
                --card:#fff;
                --text:#111827;
                --sub:#6B7280;
                --border:#E5E7EB;

                --accent:#ff6b86;
                --purple:#6366f1;

                --shadow:0 10px 26px rgba(0,0,0,0.06);
                --radius:18px;
            }
            *{box-sizing:border-box}

            /* ✅ 전체 폭/느낌: 다른 화면들이랑 맞추기 */
            .board-write-bg{
                background:var(--bg);
                padding:18px 0 26px;
            }
            .board-write-wrap{
                width:min(980px, 92vw);
                margin:0 auto;
            }

            /* 헤더 카드 */
            .bw-head{
                background:linear-gradient(135deg, rgba(255,107,134,.16), rgba(99,102,241,.14));
                border:1px solid rgba(229,231,235,.9);
                border-radius:18px;
                box-shadow:var(--shadow);
                padding:14px 16px;
                display:flex;
                align-items:center;
                justify-content:space-between;
                gap:12px;
                margin-bottom:12px;
            }
            .bw-head-left{display:flex; flex-direction:column; min-width:0;}
            .bw-title{
                margin:0;
                font-size:18px;
                font-weight:1000;
                color:var(--text);
                white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
            }
            .bw-sub{
                margin:4px 0 0;
                font-size:12px;
                font-weight:800;
                color:var(--sub);
            }

            /* 본문 카드 */
            .bw-card{
                background:var(--card);
                border:1px solid #EEF2F7;
                border-radius:18px;
                box-shadow:var(--shadow);
                overflow:hidden;
            }
            .bw-inner{ padding:14px; }

            /* 로그인 안내 */
            .need-login{
                background:#fff;
                border:1px solid var(--border);
                border-radius:18px;
                box-shadow:var(--shadow);
                padding:14px 16px;
                color:var(--text);
                font-weight:900;
                margin-bottom:12px;
            }
            .need-login small{
                display:block;
                margin-top:6px;
                font-weight:800;
                color:var(--sub);
            }

            /* 필드 */
            .field{
                border:1px solid var(--border);
                border-radius:18px;
                padding:14px;
                background:#fff;
                margin-bottom:12px;
            }
            .field label{
                display:flex;
                align-items:center;
                gap:8px;
                font-size:13px;
                font-weight:1000;
                color:var(--text);
                margin-bottom:10px;
                flex-wrap:wrap;
            }
            .req{
                font-size:11px;
                padding:3px 8px;
                border-radius:999px;
                background:rgba(255,107,134,.14);
                border:1px solid rgba(255,107,134,.22);
                color:var(--text);
                font-weight:1000;
            }
            .field input, .field select, .field textarea{
                width:100%;
                border:1px solid var(--border);
                border-radius:14px;
                padding:12px;
                font-size:13px;
                outline:none;
                background:#fff;
                color:var(--text);
            }
            .field textarea{
                min-height:220px;
                resize:vertical;
                line-height:1.6;
            }
            .field input:focus, .field select:focus, .field textarea:focus{
                border-color:rgba(99,102,241,.55);
                box-shadow:0 0 0 3px rgba(99,102,241,.12);
            }

            .error{
                margin-top:8px;
                color:#EF4444;
                font-size:12px;
                font-weight:900;
                overflow-wrap:anywhere;
            }
            .hint{
                margin-top:8px;
                color:var(--sub);
                font-size:12px;
                font-weight:800;
                overflow-wrap:anywhere;
            }

            /* 하단 고정 바 */
            .bw-bottom{
                position:sticky;
                bottom:0;
                padding-top:12px;
            }
            .bw-bottom-bar{
                background:rgba(255,255,255,.86);
                backdrop-filter:blur(10px);
                border:1px solid var(--border);
                border-radius:18px;
                box-shadow:var(--shadow);
                padding:12px;
                display:flex;
                gap:10px;
                align-items:center;
                justify-content:space-between;
            }
            .bw-submit{
                height:40px;
                padding:0 14px;
                border-radius:14px;
                border:none;
                background:linear-gradient(135deg, var(--accent), var(--purple));
                color:#fff;
                font-weight:1000;
                cursor:pointer;
                white-space:nowrap;
                box-shadow:0 12px 26px rgba(99,102,241,.18);
            }
            .bw-cancel{
                height:40px;
                padding:0 14px;
                border-radius:14px;
                border:1px solid var(--border);
                background:#fff;
                color:var(--text);
                font-weight:1000;
                cursor:pointer;
                white-space:nowrap;
                text-decoration:none;
                display:inline-flex;
                align-items:center;
                justify-content:center;
            }

            @media (max-width: 640px){
                .board-write-wrap{ width:min(680px, 94vw); }
                .bw-inner{ padding:12px; }
                .field{ padding:12px; border-radius:16px; }
                .bw-head{ border-radius:16px; }
            }
        </style>
    </th:block>
</head>

<body>
<div layout:fragment="content">

    <div class="board-write-bg">
        <div class="board-write-wrap">

            <!-- 세션 없으면 폼 자체 숨김 -->
            <div class="need-login" th:if="${session.memberId == null}">
                ⚠️ 로그인 후 이용해주세요.
                <small>로그인 후 글쓰기가 가능합니다.</small>
            </div>

            <div class="bw-head">
                <div class="bw-head-left">
                    <h1 class="bw-title">덕질게시판 글쓰기</h1>
                    <p class="bw-sub">제목/카테고리/내용만 깔끔하게 쓰면 끝!</p>
                </div>
            </div>

            <div class="bw-card" th:if="${session.memberId != null}">
                <div class="bw-inner">

                    <form th:action="@{/board/{memberId}/write(memberId=${session.memberId})}"
                          th:object="${boardWriteValid}"
                          method="post"
                          enctype="multipart/form-data">

                        <!-- 카테고리 -->
                        <div class="field">
                            <label>카테고리 <span class="req">필수</span></label>
                            <select th:field="*{categoryId}" required>
                                <option value="" disabled selected>선택하세요</option>
                                <option value="1">내 새끼 자랑</option>
                                <option value="2">코스프레</option>
                                <option value="3">자유</option>
                            </select>

                            <div class="error"
                                 th:if="${#fields.hasErrors('categoryId')}"
                                 th:errors="*{categoryId}">카테고리 에러</div>
                        </div>

                        <!-- 제목 -->
                        <div class="field">
                            <label>제목 <span class="req">필수</span></label>
                            <input type="text" th:field="*{title}" placeholder="제목을 입력하세요" required>
                            <div class="error"
                                 th:if="${#fields.hasErrors('title')}"
                                 th:errors="*{title}">제목 에러</div>
                        </div>

                        <!-- 내용 -->
                        <div class="field">
                            <label>내용 <span class="req">필수</span></label>
                            <textarea th:field="*{content}" placeholder="내용을 입력하세요" required></textarea>
                            <div class="error"
                                 th:if="${#fields.hasErrors('content')}"
                                 th:errors="*{content}">내용 에러</div>
                        </div>

                        <!-- ✅ 사진 업로드 (컨트롤러 @RequestParam("images") List<MultipartFile> images 와 동일) -->
                        <div class="field">
                            <label>사진 업로드 <span class="req">선택</span></label>
                            <input type="file" name="images" accept="image/*" multiple>
                            <div class="hint">여러 장 선택 가능 (JPG/PNG 등 이미지 파일)</div>
                        </div>

                        <div class="bw-bottom">
                            <div class="bw-bottom-bar">
                                <a class="bw-cancel" th:href="@{/board/1/list.do}">↩ 목록으로</a>
                                <button class="bw-submit" type="submit">✅ 등록하기</button>
                            </div>
                        </div>

                    </form>

                </div>
            </div>

        </div>
    </div>

</div>
</body>
</html>