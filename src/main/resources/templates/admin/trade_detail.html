<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>더쿠쿠 관리자 - 거래 상세</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --bg-body:#f5f7fb;
            --bg-card:#ffffff;
            --bg-header:#050816;
            --border-subtle:#e1e4f0;
            --ink-strong:#111827;
            --ink-muted:#6b7280;
            --accent:#2563eb;
            --danger:#ef4444;
        }
        *{box-sizing:border-box;}
        body{
            margin:0;
            font-family:system-ui,-apple-system,"Malgun Gothic",sans-serif;
            background:var(--bg-body);
            color:var(--ink-strong);
        }
        a{color:inherit;text-decoration:none;}
        button{font-family:inherit;}

        .admin-header{
            background:var(--bg-header);
            color:#f9fafb;
            padding:0 32px;
            height:56px;
            display:flex;
            align-items:center;
            justify-content:space-between;
        }
        .admin-header-left{display:flex;align-items:center;gap:16px;}
        .admin-logo{font-weight:700;font-size:18px;}
        .admin-nav-tabs{display:flex;gap:8px;}
        .admin-nav-tab{
            padding:6px 14px;
            border-radius:999px;
            font-size:13px;
            border:1px solid transparent;
            background:transparent;
            color:#e5e7eb;
        }
        .admin-nav-tab.active{
            background:#ffffff;
            color:var(--ink-strong);
            border-color:var(--border-subtle);
        }
        .admin-header-right{display:flex;align-items:center;gap:16px;font-size:13px;}
        .admin-header-link{color:#e5e7eb;}
        .admin-header-link:hover{text-decoration:underline;}

        .admin-main{
            max-width:900px;
            margin:24px auto 40px;
            padding:0 24px;
        }
        .card{
            background:var(--bg-card);
            border-radius:12px;
            border:1px solid var(--border-subtle);
            padding:20px 22px;
        }
        .card-header{
            display:flex;
            justify-content:space-between;
            align-items:flex-start;
            margin-bottom:16px;
        }
        .title-block h1{
            margin:0 0 6px;
            font-size:20px;
        }
        .title-block p{
            margin:0;
            font-size:13px;
            color:var(--ink-muted);
        }
        .badge{
            display:inline-flex;
            align-items:center;
            padding:3px 9px;
            border-radius:999px;
            font-size:11px;
            font-weight:500;
        }
        .badge-status{background:#e5f8ec;color:#166534;}
        .badge-deleted{background:#fee2e2;color:#b91c1c;}

        .meta-grid{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
            gap:10px;
            margin-bottom:16px;
            font-size:13px;
        }
        .meta-label{color:var(--ink-muted);font-size:12px;margin-bottom:2px;}
        .meta-value{font-weight:500;}

        .content-block{
            border-top:1px dashed var(--border-subtle);
            padding-top:14px;
            font-size:14px;
            line-height:1.6;
            white-space:pre-line;
        }

        .btn-row{
            margin-top:18px;
            display:flex;
            justify-content:space-between;
            flex-wrap:wrap;
            gap:8px;
        }
        .btn{
            display:inline-flex;align-items:center;justify-content:center;
            border-radius:8px;padding:0 14px;height:34px;
            font-size:13px;border:1px solid transparent;cursor:pointer;
            white-space:nowrap;
        }
        .btn-outline{background:#fff;color:var(--ink-strong);border-color:var(--border-subtle);}
        .btn-primary{background:var(--accent);color:#fff;}
        .btn-danger{background:#fee2e2;color:var(--danger);border-color:#fecaca;}
        .btn-outline:hover{background:#f9fafb;}
        .btn-primary:hover{filter:brightness(0.96);}
        .btn-danger:hover{filter:brightness(0.97);}
    </style>
</head>
<body>
<header th:replace="admin/fragments/admin_header :: adminHeader"></header>

<main class="admin-main">
    <section class="card">
        <div class="card-header">
            <div class="title-block">
                <h1 th:text="${trade.title}">거래글 제목</h1>
                <p>
                    <span th:text="${trade.seller != null ? trade.seller.nickname : '알 수 없음'}">닉네임</span>
                    ·
                    <span th:text="${#temporals.format(trade.createdAt, 'yyyy-MM-dd HH:mm')}">
                        2025-01-01 00:00
                    </span>
                    · 조회
                    <span th:text="${trade.viewCount}">0</span>
                </p>
            </div>
            <div>
                <span class="badge badge-status"
                      th:if="${trade.status == 'ON_SALE'}">판매중</span>
                <span class="badge badge-status"
                      th:if="${trade.status == 'RESERVED'}">예약중</span>
                <span class="badge badge-status"
                      th:if="${trade.status == 'COMPLETED'}">판매완료</span>

                <div style="margin-top:6px;"
                     th:if="${trade.deletedYn == 'Y'}">
                    <span class="badge badge-deleted">삭제됨(숨김 처리)</span>
                </div>
            </div>
        </div>

        <div class="meta-grid">
            <div>
                <div class="meta-label">굿즈 이름</div>
                <div class="meta-value" th:text="${trade.goodsName}">굿즈명</div>
            </div>
            <div>
                <div class="meta-label">작품명</div>
                <div class="meta-value" th:text="${trade.workName}">작품명</div>
            </div>
            <div>
                <div class="meta-label">캐릭터명</div>
                <div class="meta-value" th:text="${trade.characterName}">캐릭터</div>
            </div>
            <div>
                <div class="meta-label">카테고리</div>
                <div class="meta-value" th:text="${trade.category}">카테고리</div>
            </div>
            <div>
                <div class="meta-label">가격</div>
                <div class="meta-value">
                    <span th:if="${trade.price != null}"
                          th:text="${#numbers.formatInteger(trade.price, 0, 'COMMA')} + '원'">10,000원</span>
                    <span th:if="${trade.price == null}">-</span>
                </div>
            </div>
            <div>
                <div class="meta-label">거래 방식</div>
                <div class="meta-value" th:text="${trade.tradeMethod}">직거래</div>
            </div>
            <div>
                <div class="meta-label">거래 유형</div>
                <div class="meta-value" th:text="${trade.tradeType}">판매</div>
            </div>
            <div>
                <div class="meta-label">지역</div>
                <div class="meta-value" th:text="${trade.region}">서울</div>
            </div>
        </div>

        <div class="content-block" th:text="${trade.content}">
            내용
        </div>

        <div class="btn-row">
            <div>
                <!-- 목록으로 -->
                <a class="btn btn-outline"
                   th:href="@{/admin/trades(page=${page}, keyword=${keyword})}">
                    목록으로
                </a>
            </div>
            <div style="display:flex; gap:6px; flex-wrap:wrap;">
                <!-- 상태 변경 예시 -->
                <form th:action="@{/admin/trades/{id}/status(id=${trade.id})}"
                      method="post" style="margin:0;">
                    <input type="hidden" name="page" th:value="${page}">
                    <input type="hidden" name="keyword" th:value="${keyword}">
                    <select name="status" style="height:34px; border-radius:8px; border:1px solid #d1d5db; font-size:13px;">
                        <option value="ON_SALE" th:selected="${trade.status == 'ON_SALE'}">판매중</option>
                        <option value="RESERVED" th:selected="${trade.status == 'RESERVED'}">예약중</option>
                        <option value="COMPLETED" th:selected="${trade.status == 'COMPLETED'}">판매완료</option>
                    </select>
                    <button type="submit" class="btn btn-primary">상태 변경</button>
                </form>

                <!-- 삭제 / 복구 -->
                <form th:if="${trade.deletedYn != 'Y'}"
                      th:action="@{/admin/trades/{id}/delete(id=${trade.id})}"
                      method="post" style="margin:0;">
                    <input type="hidden" name="page" th:value="${page}">
                    <input type="hidden" name="keyword" th:value="${keyword}">
                    <button type="submit" class="btn btn-danger">삭제(숨김)</button>
                </form>

                <form th:if="${trade.deletedYn == 'Y'}"
                      th:action="@{/admin/trades/{id}/restore(id=${trade.id})}"
                      method="post" style="margin:0;">
                    <input type="hidden" name="page" th:value="${page}">
                    <input type="hidden" name="keyword" th:value="${keyword}">
                    <button type="submit" class="btn btn-primary">복구</button>
                </form>
            </div>
        </div>
    </section>
</main>

</body>
</html>
