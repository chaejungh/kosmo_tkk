<!DOCTYPE html>
<html lang="ko"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{fragments/fragments/layout}">
<head>
    <th:block layout:fragment="head">
        <!-- âœ… ìƒëŒ€ê²½ë¡œ ê¸ˆì§€: URLì´ /store/... ì´ë“  /goods/store/... ì´ë“  ë¬´ì¡°ê±´ ë™ì¼í•˜ê²Œ ë¡œë“œë¨ -->
        <link rel="stylesheet" th:href="@{/css/tkk.css}">
    </th:block>
</head>

<body class="tkk-body">
<div layout:fragment="content" class="tkk-container">

    <div class="store-wrap">

        <a class="store-back" th:href="@{/}">â† ëŒì•„ê°€ê¸°</a>

        <!-- ì»¤ë²„(ë°°ê²½ ì´ë¯¸ì§€) -->
        <div class="store-cover"
             th:style="|background-image:url('${store.imageUrl}')|"></div>

        <div class="store-body">

            <!-- LEFT -->
            <section class="store-left">

                <div class="store-header">
                    <div>
                        <h1 th:text="${store.name}">ë§¤ì¥ëª…</h1>
                        <!-- í‰ì /ë¦¬ë·°ëŠ” ë°ì´í„° ì—†ìœ¼ë©´ í‘œì‹œë§Œ (ì›í•˜ë©´ ë‚˜ì¤‘ì— ì—”í‹°í‹°/ì»¬ëŸ¼ ì¶”ê°€) -->
                        <div class="store-rating">â­ 4.8 (234)</div>
                    </div>

                    <!-- ì°œ(ì¢‹ì•„ìš”) -->
                    <button type="button"
                            class="heart-btn"
                            th:classappend="${liked} ? ' active' : ''"
                            aria-label="ì°œí•˜ê¸°">
                        â™¥
                    </button>
                </div>

                <p class="store-desc" th:text="${store.description}">
                    ë§¤ì¥ ì„¤ëª…
                </p>

                <div class="store-info-box">
                    <div class="store-info-row">
                        <span class="ico">ğŸ“</span>
                        <span class="val" th:text="${store.address}">ì£¼ì†Œ</span>
                    </div>
                    <div class="store-info-row">
                        <span class="ico">â°</span>
                        <span class="val" th:text="${store.openTime}">ì˜ì—…ì‹œê°„</span>
                    </div>
                    <div class="store-info-row">
                        <span class="ico">ğŸ“</span>
                        <span class="val" th:text="${store.tel}">ì „í™”ë²ˆí˜¸</span>
                    </div>
                </div>

                <div class="store-actions">
                    <!-- ê¸¸ì°¾ê¸°: êµ¬ê¸€ì§€ë„ ê²€ìƒ‰(ì£¼ì†Œ ê¸°ì¤€) -->
                    <a class="btn-primary"
                       target="_blank"
                       rel="noopener"
                       th:href="|https://www.google.com/maps/search/?api=1&query=${store.address}|">
                        ê¸¸ì°¾ê¸°
                    </a>

                    <!-- ì „í™”í•˜ê¸° -->
                    <a class="btn-secondary"
                       th:href="|tel:${store.tel}|">
                        ì „í™”í•˜ê¸°
                    </a>
                </div>
            </section>

            <!-- RIGHT (ì¬ê³ ) -->
            <aside class="store-right">
                <h3>ì‹¤ì‹œê°„ ì¬ê³  í˜„í™©</h3>

                <div th:if="${#lists.isEmpty(goodsList)}" style="opacity:.8; font-weight:900;">
                    ë“±ë¡ëœ êµ¿ì¦ˆê°€ ì—†ìŠµë‹ˆë‹¤.
                </div>

                <div th:each="g : ${goodsList}" class="stock-row"
                     th:attr="data-qty=${g.stockQty}">
                    <div class="stock-line">
                        <div class="stock-name" th:text="${g.name}">êµ¿ì¦ˆëª…</div>
                        <div class="stock-qty"><span th:text="${g.stockQty}">0</span>ê°œ</div>
                    </div>
                    <div class="stock-bar"><span></span></div>
                </div>
            </aside>

        </div>
    </div>

    <!-- âœ… ë°”(í¼ì„¼íŠ¸) ê³„ì‚°: ìµœëŒ€ ì¬ê³  ëŒ€ë¹„ ë¹„ìœ¨ë¡œ í‘œì‹œ -->
    <script>
        (function () {
            const rows = Array.from(document.querySelectorAll('.stock-row'));
            if (!rows.length) return;

            const qtys = rows.map(r => Number(r.getAttribute('data-qty') || 0));
            const max = Math.max(...qtys, 1);

            rows.forEach(r => {
                const qty = Number(r.getAttribute('data-qty') || 0);
                const pct = Math.round((qty / max) * 100);
                const bar = r.querySelector('.stock-bar span');
                if (bar) bar.style.width = pct + '%';
            });
        })();
    </script>

</div>
</body>
</html>