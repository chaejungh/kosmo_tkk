<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>나의 더쿠쿠</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- 마이페이지 전용 CSS -->
    <link rel="stylesheet" href="/css/mypage.css">
</head>

<body>
<div class="mypage-page">

    <!-- 제목 -->
    <h2 class="title">나의 더쿠쿠</h2>

    <!-- 프로필 카드 -->
    <div class="profile-card">
        <label for="profileImageInput" class="profile-img-wrapper">
            <!-- 프로필 이미지 -->
            <img id="profileImage" class="profile-img"
                 src="/images/default_profile.png" alt="프로필">
        </label>
        <input id="profileImageInput" type="file" accept="image/*" style="display:none;">

        <div class="profile-info">
            <div class="level-badge">LV3</div>

            <!-- 닉네임 (클릭해서 수정) -->
            <div id="nickname" class="nickname editable" th:text="${member.nickname}">

            </div>

            <!-- 한 줄 소개 -->
            <div id="intro" class="intro editable" th:text="${member.intro}">한 줄 소개를 입력해 주세요.</div>

            <!-- ========== 닉네임 변경 영역 ========== -->
            <div class="profile-edit-box">

                <!-- 닉네임 변경 버튼 -->
                <button id="nicknameEditBtn" class="nickname-edit-btn">
                    닉네임 변경
                </button>

                <!-- 닉네임 변경 폼 (처음에는 숨김) -->
                <form id="nicknameForm"
                      th:action="@{'/mypage/' + ${member.id} + '/profile'}"
                      method="post"
                      style="display:none; margin-top:12px;">

                    <input type="text"
                           name="nickname"
                           placeholder="새 닉네임을 입력하세요"
                           required
                           class="nickname-input">

                    <input type="hidden" name="intro" value="">
                    <input type="hidden" name="profileImage" th:value="${member.profileImageUrl}">
                    <button type="submit" class="nickname-save-btn">저장</button>

                    <!-- 🔥 새로 추가되는 취소 버튼 -->
                    <button type="button" id="nicknameCancelBtn" class="nickname-cancel-btn">
                        취소
                    </button>
                </form>
            </div>
            <script>
                document.getElementById("nicknameEditBtn").onclick = function () {
                    document.getElementById("nicknameForm").style.display = "block";
                };

                // 🔥 취소 버튼 클릭 시 입력폼 숨기기
                document.getElementById("nicknameCancelBtn").onclick = function () {
                    document.getElementById("nicknameForm").style.display = "none";
                };
            </script>
        </div>
    </div>

    <!-- 섹션 1 : 나의 활동 -->
    <div class="section-box">
        <div class="section-title">나의 활동</div>

        <a class="item" th:href="@{'/mypage/' + ${member.id} + '/posts'}">
            <span class="main">📝 내가 쓴 글</span>
            <span class="sub">굿즈로드에서 내가 작성한 글 전체 보기</span>
        </a>


        <a class="item" th:href="@{'/mypage/' + ${member.id} + '/likes'}">
            <span class="main">❤️ 좋아요 한 글</span>
            <span class="sub">좋아요한 게시글/거래글 모아보기</span>
        </a>

        <a class="item" th:href="@{'/mypage/' + ${member.id} + '/bookmarks'}">
            <span class="main">📌 북마크 한 게시글</span>
            <span class="sub">북마크 한 게시글/거래글 모아보기</span>
        </a>
    </div>

    <!-- 섹션 2 : 굿즈 거래 -->
    <div class="section-box">
        <div class="section-title">굿즈 거래</div>

        <a class="item" th:href="@{'/mypage/' + ${member.id} + '/trade/mine'}">
            <span class="main">📦 내가 올린 거래 글</span>
            <span class="sub">내가 등록한 거래글 전체 보기</span>
        </a>



        <a class="item" th:href="@{'/mypage/' + ${member.id} + '/trade/wishlist'}">
            <span class="main">💗 찜한 거래글</span>
            <span class="sub">관심 있는 거래글 찜 목록</span>
        </a>


    </div>

    <!-- 섹션 3 : 매장 & 팝업 -->
    <div class="section-box">
        <div class="section-title">매장 & 팝업</div>

        <a class="item" th:href="@{/mypage/{memberId}/stores(memberId=${member.id})}">
            <span class="main">🏪 찜한 매장</span>
            <span class="sub">자주 가는 굿즈 매장 즐겨찾기</span>
        </a>

        <a class="item" th:href="@{/mypage/{memberId}/popups(memberId=${member.id})}">
            <span class="main">🎪 찜한 팝업스토어</span>
            <span class="sub">놓치기 싫은 팝업스토어 저장 목록</span>
        </a>
    </div>



    <!-- 섹션 5 : 설정 · 고객센터 -->
    <div class="section-box">
        <div class="section-title">설정 · 고객센터</div>

        <a class="item" href="/mypage/service/setting">
            <span class="main">⚙ 계정 · 알림 설정</span>
            <span class="sub">로그인/보안, 알림 수신 설정</span>
        </a>

        <a class="item" href="/mypage/service/notice">
            <span class="main">📢 공지사항 / 이벤트 </span>
            <span class="sub">서비스 공지 및 이벤트 안내</span>
        </a>

        <a class="item" href="/mypage/service/faq">
            <span class="main">❓ 자주 묻는 질문</span>
            <span class="sub">많이 물어보는 질문 모아보기</span>
        </a>

        <a class="item" th:href="@{'/mypage/service/' + ${memberId} + '/inquiries'}">
            <span class="main">💬 1:1 문의</span>
            <span class="sub">궁금한 점을 직접 문의하기</span>
        </a>

        <a class="item danger" href="/mypage/service/logout">
            <span class="main">🚪 로그아웃 / 회원탈퇴</span>
        </a>
    </div>

</div>

<nav class="bottom-nav">
    <a th:href="@{/}" class="nav-item">
        <span class="icon">🏠</span>
        <span>홈</span>
    </a>
    <a th:href="@{/board}" class="nav-item">
        <span class="icon">📁</span>
        <span>덕질게시판</span>
    </a>
    <a th:href="@{/mypage}" class="nav-item active">
        <span class="icon">👤</span>
        <span>내정보</span>
    </a>
</nav>

<script src="/js/mypage.js"></script>
</body>
</html>